<div fxLayout="column" fxLayoutAlign="center stretch">
    <div fxLayout="row" fxFlex="100">
        <div fxFlex="80">
            <div fxLayout="column">
                <div fxLayout="column" fxLayoutAlign="start start">
                    <div fxLayout="row" fxLayoutAlign="start start">
                        <mat-icon *ngIf="connectService.isDataSetDescription(adapter)" class="historic">lens</mat-icon>
                        <mat-icon *ngIf="connectService.isDataStreamDescription(adapter)" class="real-time">lens</mat-icon>
                        <div fxLayoutAlign="start center">
                        <p *ngIf="connectService.isDataSetDescription(adapter)">&nbsp;Data Set</p>
                        <p *ngIf="connectService.isDataStreamDescription(adapter)">&nbsp;Data Stream</p>
                        </div>
                    </div>
                </div>
                <h1 class="new-adapter-title">New Source: {{adapter.label}}</h1>
            </div>
        </div>
        <div fxFlex="20" fxLayoutAlign="end start">
            <button mat-icon-button (click)="removeSelection()">
                <i class="material-icons">close</i>
            </button>
        </div>

    </div>
    <mat-horizontal-stepper [linear]="isLinearStepper" #stepper>

        <mat-step>
            <ng-template matStepLabel>Settings</ng-template>
            <div class="assemblyOptions sp-blue-bg">
                <h4 *ngIf="!adapter.id.includes('generic')">Basic settings</h4>
                <h4 *ngIf="adapter.id.includes('generic')">Protocol settings</h4>
            </div>
            <div class="sp-blue-border padding">
                <app-static-property *ngFor="let config of adapter.config" [staticProperty]="config"></app-static-property>
                <app-protocol [protocol]="adapter.protocol" *ngIf="adapter.id.includes('generic')"></app-protocol>
            </div>

            <div fxLayoutAlign="end">
                <button class="mat-basic" mat-raised-button (click)="removeSelection()">Cancel</button>
                <button id="specific-settings-next-button" (click)="clickSpecificSettingsNextButton()" color="primary"
                        mat-raised-button matStepperNext style="margin-left:10px;">Next
                </button>
            </div>
        </mat-step>

        <mat-step *ngIf="adapter.id.includes('generic')">
            <form>
                <ng-template matStepLabel>Select Format</ng-template>

                    <div class="assemblyOptions sp-blue-bg">
                        <h4>Select format</h4>
                    </div>
                    <div class="sp-blue-border padding">
                        <app-format-form fxFlex="100" (selectedFormatEmitter)="formatSelected($event)"
                                         [(selectedFormat)]="adapter.format"
                                         [allFormats]="allFormats"></app-format-form>
                    </div>

                    <div class="assemblyOptions sp-blue-bg">
                        <h4>Configure format</h4>
                    </div>
                    <div class="sp-blue-border padding">
                        <div fxFlex="100" *ngIf="adapter.format">
                            <app-select-static-properties [staticProperties]="adapter.format.config"
                                                          class="fullWidth"></app-select-static-properties>
                            <h5 *ngIf="adapter.format.config.length === 0" style="text-align:center;">(no further configuration needed)</h5>
                        </div>
                    </div>

                <div fxLayoutAlign="end">
                    <button class="mat-basic" mat-raised-button (click)="removeSelection()">Cancel</button>
                    <button class="mat-basic" mat-raised-button matStepperPrevious style="margin-left:10px;">Back</button>
                    <button id="format-selection-next-button" (click)="clickFormatSelectionNextButton()" color="primary"
                            mat-raised-button matStepperNext style="margin-left:10px;">
                        Next
                    </button>
                </div>
            </form>

        </mat-step>

        <mat-step>
            <ng-template matStepLabel>Define Event Schema</ng-template>
            <div class="assemblyOptions sp-blue-bg">
                <h4>Edit schema</h4>
            </div>
            <div class="sp-blue-border padding">
            <app-event-schema #eschema fxLayout="column" fxFlex="100" [(adapterDescription)]="adapter"
                              [(eventSchema)]="eventSchema" [(oldEventSchema)]="oldEventSchema"></app-event-schema>
            </div>

            <div fxLayoutAlign="end">
                <button class="mat-basic" mat-raised-button (click)="removeSelection()">Cancel</button>
                <button class="mat-basic" mat-raised-button matStepperPrevious style="margin-left:10px;">Back</button>
                <button id="event-schema-next-button" (click)="clickEventSchemaNextButtonButton()" color="primary"
                        (click)="setSchema()" mat-raised-button matStepperNext style="margin-left:10px;">Next
                </button>
            </div>
        </mat-step>

        <mat-step>


            <ng-template matStepLabel>Start Adapter</ng-template>
            <div class="assemblyOptions sp-blue-bg">
                <h4>Adapter settings</h4>
            </div>
            <div class="sp-blue-border padding">
                <div fxLayoutAlign="center" fxLayout="column" fxFlex="100">
                    <mat-form-field>
                        <input matInput id="input-AdapterName" placeholder="Adapter Name" [(ngModel)]="adapter.label">
                    </mat-form-field>
                </div>
            </div>

            <div fxLayoutAlign="end">
                <button class="mat-basic" mat-raised-button (click)="removeSelection()">Cancel</button>
                <button class="mat-basic" mat-raised-button matStepperPrevious style="margin-left:10px;">Back</button>
                <button mat-raised-button id="button-startAdapter" color="primary" (click)="startAdapter()" mat-button style="margin-left:10px;">
                    Start Adapter
                </button>
            </div>
        </mat-step>

    </mat-horizontal-stepper>

</div>